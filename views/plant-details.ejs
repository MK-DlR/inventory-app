<!-- views/plant-details.ejs -->

<!DOCTYPE html>
<html lang="en">
    <%- include("./partials/head.ejs") %>
    <body>
        <h1 class="centered details-head">Plant Details</h1>
        <div class="plant-list">
            <div class="plant-card card-lg"
                data-common="<%= plant.common_name %>" 
                data-scientific="<%= plant.scientific_name %>"
                data-quantity="<%= quantityToSortValue(plant.quantity_level) %>"
                data-created="<%= plant.created_at %>"
                data-updated="<%= plant.updated_at %>">
                <img src="<%= plant.image_url %>" class="card-img img-lg">
                <p class="plant-name-lg">
                    <strong class="common-name-lg"><%= plant.common_name %></strong><br>
                    <em class="scientific-name-lg"><%= plant.scientific_name %></em>
                </p>
                <div class="plant-status status-lg">
                    <div style="display: flex; gap: 0.7rem;"> <!-- Wrap badges in a container -->
                        <div class="stock badge badge-lg badge-<%= plant.stock_status.toLowerCase().replace(/\s+/g, '-') %>">
                            <i class="fa-solid fa-leaf"></i> <%= formatStockStatus(plant.stock_status) %>
                        </div>

                        <% if (plant.quantity_level) { %>
                            <div class="quantity badge badge-lg badge-<%= plant.quantity_level.toLowerCase().replace(/\s+/g, '-') %>">
                                <i class="fa-solid fa-ranking-star"></i> <%= formatQuantityLevel(plant.quantity_level) %>
                            </div>
                        <% } %>

                        <% if (plant.order_status) { %>
                            <div class="order badge badge-lg badge-<%= plant.order_status.toLowerCase().replace(/\s+/g, '-') %>">
                                <i class="fa-solid fa-box-archive"></i> <%= formatStockStatus(plant.order_status) %>
                            </div>
                        <% } %>
                    </div>
                    
                    <div class="control-buttons">
                        <button onclick="window.location.href='/plants/<%= plant.id %>/edit';" class="button control-plants"><i class="fa-solid fa-pencil"></i></button>
                        <form action="/plants/<%- plant.id %>/delete" method="POST" onsubmit="return confirm('Are you sure to want to delete this plant?');">
                            <button type="submit" class="button control-plants"><i class="fa-regular fa-trash-can"></i></button>
                        </form>
                    </div>
                </div>
                <div class="plant-medicinal content">
                    <% if (plant.medicinal_uses && plant.medicinal_uses.length > 0) { %>
    <h2 class="centered">Medicinal Uses (<%= plant.medicinal_uses.length %>)</h2>
        <ul class="stacked-list">
            <% plant.medicinal_uses.forEach(use => { %>
            <li class="list-item">
                <a href="/medicinal/<%= use.id %>" class="list-link">
                <div class="list-content">
                    <div class="list-main">
                    <p class="list-title"><%= use.use_name %></p>
                    </div>
                </div>
                <svg class="chevron-icon" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                    <path fill-rule="evenodd" d="M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
                </svg>
                </a>
            </li>
        <% }) %>
    </ul>
<% } else { %>
    <h2 class="centered">Medicinal Uses (0)</h2>
    <div class="centered no-uses">
        No medicinal uses listed for this plant.
    </div>
<% } %>
                </div>    
            </div>
        </div>
    </body>
</html>